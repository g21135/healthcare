<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE sqlMap
			PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
			"http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="prod">

	<select id="prodlist" parameterClass="prodVO" resultClass="prodVO">
	
select prod_name,
		   prod_no,
		   prod_content,
		   prod_photo,
		   prod_price
	FROM ProdVO
	WHERE div_code in (1,2)
		</select>
	
	<select id="healthprodlist" parameterClass="prodVO" resultClass="prodVO">
	
	select prod_name,
		   prod_no,
		   prod_content,
		   prod_photo,
		   prod_price
	FROM ProdVO
	WHERE div_code = 1	
	</select>
	
	<select id="foodprodlist" parameterClass="prodVO" resultClass="prodVO">
	
	select prod_name,
		   prod_no,
		   prod_content,
		   prod_photo,
		   prod_price
	FROM ProdVO
	WHERE div_code = 2	
	</select>
	
	<select id= "prodselectlist" parameterClass="int" resultClass="prodVO">
	
	select *
	FROM ProdVO
	WHERE prod_no = #prod_no#
	
	
	
	</select>
	
	<select id="getSearchFood" parameterClass="prodVO" resultClass="prodVO">
		select prod_name
		from prodvo
		where div_code = 2 and prod_name like  '%' || #prod_name# || '%'
	</select>

	<select id="prodmagerment" parameterClass="prodVO" resultClass="prodVO" >
	
		select prod_no,prod_name ,prod_content , prod_price , remain_outstock ,remain_curstock, prod_check,prod_photo
		from prodvo 
		where prod_check = 0 
		order by prod_no asc
		
	</select>
	
	
	<delete id="ProdListDelete" parameterClass="prodVO" >
	
		delete from prodvo where prod_check = 1
	</delete>
	
	<update id="ProdSelectUpdate" parameterClass="prodVO">
	
	
	update prodvo
	set prod_check = 1
	where prod_no=#prod_no#
	
	</update>
	
	
	<update id="ProdCheckUpdate" parameterClass="prodVO">
	
	
	update prodvo
	set prod_check = 0
	where prod_no=#prod_no#
	
	</update>
	
	<select id="paymagerment" parameterClass="prodVO" resultClass="prodVO">
	
	select d.deal_no,p.prod_no,p.prod_name , m.mem_name ,d.deal_date , m.mem_tel
	from prodvo p , dealhistoryvo d , membervo m
	where p.prod_name = d.order_prodname and d.mem_id = m.mem_id
	</select>
	
	<insert id="prodadd" parameterClass="prodVO">
	insert into prodvo (prod_no,div_code,prod_name,prod_content,prod_photo,prod_price,prod_check,remain_outstock,remain_curstock) 
	values ((SELECT NVL(MAX(prod_no),0)+1 FROM prodvo),1,#prod_name#,#prod_content#,#prod_photo#,#prod_price#,0,0,500)
	</insert>
	
	<insert id="remainadd" parameterClass="prodVO">
	insert into remainvo(remain_yearmonth,prod_no,remain_curstock,remain_outstock)
	values ((SELECT TO_CHAR(SYSDATE, 'YYYYMMDD') FROM DUAL),(select nvl(max(prod_no),0) from prodvo),500,0);
	</insert>
</sqlMap>